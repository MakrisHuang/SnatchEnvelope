<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3"
      ng-app="RequestEnvelope">
    <head>
        <title>Snatching Envelope</title>
        <!--Bootstrap and jquery-->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/css/bootstrap.min.css"
              integrity="sha384-Zug+QiDoJOrZ5t4lssLdxGhVrurbmBWopoEl+M6BdEfwnCJZtKxi1KgxUyJq13dy"
              crossorigin="anonymous"></link>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.3/js/bootstrap.min.js"></script>

        <!-- angularJS -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.6/angular.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.6.6/angular-route.min.js"></script>

        <script th:inline="javascript">
            /*<![CDATA[*/
            var app = angular.module('RequestEnvelope', []);
            app.controller('HomeController', ['$scope', '$http', function($scope, $http){
                $scope.results = [];

                $scope.requestEnvelope = function(){
                    var max = 30;
                    for (var i = 1; i <= max; i++){
                        var url = "http://localhost:8080/snatchEnvelopeByRedis?envelopeId=1&userId=" + i;
                        $http.get(url).then(function(response){
                            $scope.results.push(response.data);
                            console.log(response.data);
                        });
                    }
                };

                $scope.requestEnvelope();
            }]);
            /*]]>*/
        </script>
    </head>
    <body ng-controller="HomeController">
        <h1 th:inline="text">Hello [[${#httpServletRequest.remoteUser}]]!</h1>
        <h3>Results of snatching envelope</h3>
        <ul ng-repeat="result in results">
            <li>{{result}}</li>
        </ul>
        <form th:action="@{/logout}" method="post">
            <input type="submit" value="Sign Out"/>
        </form>
    </body>
</html>